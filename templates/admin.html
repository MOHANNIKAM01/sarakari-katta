{% extends "base.html" %}

{# ✅ Admin वर ads नको #}
{% set show_ads = false %}

{% block content %}

<div class="admin-head">
  <h1>Admin Panel</h1>
  <div class="admin-actions">
    <a class="btn outline" href="{{ url_for('admin_logout') }}">Logout</a>
  </div>
</div>

<div class="admin-grid">
  <div class="panel">
    <h2>Create Post</h2>
    <form method="post" class="form">
      <input type="hidden" name="action" value="create" />

      <label>Title</label>
      <input name="title" required />

      <label>Category</label>
      <select name="category" required>
        {% for key,label in categories %}
          <option value="{{ key }}">{{ label }}</option>
        {% endfor %}
      </select>

      <label>Summary</label>
      <textarea name="summary" rows="3" required></textarea>

      <label>Content (HTML allowed)</label>
      <textarea name="content" rows="8" required placeholder="उदा: <ul><li>...</li></ul>"></textarea>

      <label>Official Website Link (optional)</label>
      <input name="official_link" />

      <label>Form Link (optional)</label>
      <input name="form_link" />

      <button class="btn" type="submit">Publish</button>
    </form>
  </div>

  <div class="panel">
    <h2>All Posts ({{ posts|length }})</h2>
    <div class="table">
      {% for p in posts %}
        <div class="row">
          <div>
            <div class="row-title">{{ p['title'] }}</div>
            <div class="muted small">
              {{ p['category'] }} • {{ p['created_at'][:10] }}
            </div>
          </div>
          <form method="post">
            <input type="hidden" name="action" value="delete" />
            <input type="hidden" name="post_id" value="{{ p['id'] }}" />
            <button class="btn danger" type="submit">Delete</button>
          </form>
        </div>
      {% endfor %}
    </div>
  </div>

  <div class="panel">
    <h2>Change Password</h2>
    <form method="post" class="form">
      <input type="hidden" name="action" value="update_password" />

      <label>Old Password</label>
      <input name="old_password" type="password" required />

      <label>New Password</label>
      <input name="new_password" type="password" required />

      <button class="btn outline" type="submit">Update</button>
    </form>
  </div>
</div>

{% endblock %}